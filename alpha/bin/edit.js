// Generated by CoffeeScript 1.7.1
(function() {
  define(["jquery", "mods/dom", "commands", "layout"], function($, Dom, cmd, Layout) {
    var Edit;
    Edit = (function() {
      function Edit(editor) {
        var self;
        this.editor = editor;
        this.lines = $("#lines");
        this.editor.focus();
        this.buffer = null;
        this.cx = 0;
        this.cy = 0;
        this.lineCount = 0;
        this.tw = this.editor.css("font-size") - 4;
        this.th = this.editor.css("font-size") + 11;
        this.cw = this.editor.width();
        this.ch = this.editor.height();
        this.ux = Math.floor(this.cw / this.tw);
        this.uy = Math.floor(this.ch / this.th);
        this.line();
        self = this;
        window.addEventListener("resize", function(e) {
          (new Layout).resize();
          return setTimeout((function() {
            return self.editor.focus();
          }), 500);
        });
      }

      Edit.prototype.line = function() {
        var lines;
        this.lineCount = this.lineCount + 1;
        lines = (new Dom).find("#lines").element;
        return this.lines.append($("<li/>").attr("line", this.lineCount).text(this.lineCount));
      };

      Edit.prototype.load = function(text) {
        return this.buffer = text;
      };

      Edit.prototype.run = function(key, e) {
        return cmd.run(key, e, this);
      };

      return Edit;

    })();
    return Edit;
  });

}).call(this);
